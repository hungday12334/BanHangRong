<!-- Scripts Fragment -->
<section th:fragment="scripts">
  <script>
    // Seller-only app: default role set to SELLER for any client logic relying on it
    window.currentUserType = 'SELLER';
    try {
      const btn = document.getElementById('pm_publish');
      if (btn) {
        // Clear any admin-specific tooltip text
        btn.removeAttribute('title');
      }
    } catch (e) { }
  </script>
  <!-- Live clock updater for seller dashboard header -->
  <script>
    (function () {
      function pad(n) { return n < 10 ? '0' + n : n; }
      function updateClock() {
        const el = document.getElementById('sellerClock');
        if (!el) return;
        const now = new Date();
        const hours = pad(now.getHours());
        const mins = pad(now.getMinutes());
        const secs = pad(now.getSeconds());
        el.textContent = hours + ':' + mins + ':' + secs;
      }
      // update immediately and then every second
      document.addEventListener('DOMContentLoaded', function () {
        updateClock();
        setInterval(updateClock, 1000);
      });
    })();
  </script>

  <!-- Load unread chat count for sidebar badge -->
  <script>
    (function() {
      function loadUnreadChatCount() {
        // Get current user ID from Thymeleaf (if available)
        const userIdMeta = document.querySelector('meta[name="user-id"]');
        if (!userIdMeta) return;

        const userId = userIdMeta.content;

        fetch(`/api/conversations/${userId}`)
          .then(res => res.json())
          .then(conversations => {
            let totalUnread = 0;
            conversations.forEach(conv => {
              totalUnread += (conv.unreadCount || 0);
            });

            const badge = document.getElementById('unreadChatCount');
            if (badge) {
              if (totalUnread > 0) {
                badge.textContent = totalUnread > 9 ? '9+' : totalUnread;
                badge.style.display = 'inline-flex';
              } else {
                badge.style.display = 'none';
              }
            }
          })
          .catch(err => {
            console.error('Failed to load unread count:', err);
          });
      }

      // Load on page ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadUnreadChatCount);
      } else {
        loadUnreadChatCount();
      }

      // Refresh every 30 seconds
      setInterval(loadUnreadChatCount, 30000);
    })();
  </script>

  <script src="/js/seller-dashboard.js"></script>
</section>
















<!-- <iframe width="1310" height="737" src="https://www.youtube.com/embed/onaM4uypsi0?list=RDonaM4uypsi0" title="莫问归期 X 辞九门回忆 (Từ Cửu Môn Hồi Ức x Mạc Vấn Quy Kỳ) - REMIX BY DJ啊玄 • Hot Trend Tiktok Douyin" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe> -->