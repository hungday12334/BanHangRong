<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin BanHangRong</title>
    <link rel="shortcut icon" th:href="@{/img/favicon.png}" />
    <link rel="stylesheet" th:href="@{/css/styles.min.css}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <style>
        .card {
            border: none;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h2.fw-bold {
            color: #2b6cb0;
        }
    </style>
</head>

<body>
    <div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full">
        <!-- Sidebar Start -->
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div>
                <div class="brand-logo d-flex flex-column align-items-center justify-content-center py-3">
                    <a th:href="@{/admin/index}" class="text-center">
                        <img th:src="@{/img/favicon.png}" alt="LOGO"
                            style="width: 80px; height: auto; display: block; margin: 0 auto;">
                        <span
                            style="display: block; margin-top: 8px; font-weight: 700; font-size: 18px; color: #333;">BanHangRong</span>
                    </a>
                    <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer mt-2" id="sidebarCollapse">
                        <i class="ti ti-x fs-6"></i>
                    </div>
                </div>
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
                    <ul id="sidebarnav">
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">Lists</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link justify-content-between" th:href="@{/admin/index}"
                                aria-expanded="false">
                                <div class="d-flex align-items-center gap-3">
                                    <span class="d-flex">
                                        <i class="bi bi-house-door-fill"></i>
                                    </span>
                                    <span class="hide-menu">DASHBOARD</span>
                                </div>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" th:href="@{/admin/user}" aria-expanded="false">
                                <i class="bi bi-person-circle"></i>
                                <span class="hide-menu">USER MANAGEMENT</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link justify-content-between" th:href="@{/admin/product}"
                                aria-expanded="false">
                                <div class="d-flex align-items-center gap-3">
                                    <span class="d-flex">
                                        <i class="bi bi-key-fill"></i>
                                    </span>
                                    <span class="hide-menu">PRODUCT MANAGEMENT</span>
                                </div>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link justify-content-between has-arrow" href="javascript:void(0)"
                                aria-expanded="false">
                                <div class="d-flex align-items-center gap-3">
                                    <span class="d-flex">
                                        <i class="bi bi-patch-question-fill"></i>
                                    </span>
                                    <span class="hide-menu">HELP</span>
                                </div>
                            </a>
                            <ul aria-expanded="false" class="collapse first-level">
                                <li class="sidebar-item">
                                    <a class="sidebar-link justify-content-between" href="#">
                                        <div class="d-flex align-items-center gap-3">
                                            <div class="round-16 d-flex align-items-center justify-content-center">
                                                <i class="ti ti-circle"></i>
                                            </div>
                                            <span class="hide-menu">REPORT</span>
                                        </div>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a class="sidebar-link justify-content-between" href="#">
                                        <div class="d-flex align-items-center gap-3">
                                            <div class="round-16 d-flex align-items-center justify-content-center">
                                                <i class="ti ti-circle"></i>
                                            </div>
                                            <span class="hide-menu">APPLY TO SELLER</span>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link justify-content-between" href="#" aria-expanded="false">
                                <div class="d-flex align-items-center gap-3">
                                    <span class="d-flex">
                                        <i class="bi bi-gear-fill"></i>
                                    </span>
                                    <span class="hide-menu">SETTING</span>
                                </div>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <form th:action="@{/logout}" method="post" style="display: inline;">
                                <button type="submit" class="sidebar-link justify-content-between"
                                    style="background: none; border: none; width: 100%; text-align: left; padding: 0;">
                                    <div class="d-flex align-items-center gap-3">
                                        <span class="d-flex">
                                            <i class="bi bi-box-arrow-right"></i>
                                        </span>
                                        <span class="hide-menu">LOGOUT</span>
                                    </div>
                                </button>
                            </form>
                        </li>
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
        <!--  Sidebar End -->
        <!--  Main wrapper -->
        <div class="body-wrapper">
            <div class="body-wrapper-inner">
                <div class="container-fluid">
                    <!--  Code o day -->
                    <!-- DASHBOARD CONTENT -->
                    <div class="container mt-4">

                        <!-- USER STATISTICS -->
                        <div class="row mb-5">
                            <div class="col-md-4">
                                <div class="card shadow-sm p-3 text-center">
                                    <h5 class="text-muted">Total Users</h5>
                                    <h2 th:text="${totalUsers}" class="fw-bold"></h2>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="card shadow-sm p-3">
                                    <h6 class="text-center mb-3 fw-semibold">User Role Distribution</h6>
                                    <div id="userRoleChart" style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- PRODUCT STATISTICS -->
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card shadow-sm p-3 text-center">
                                    <h5 class="text-muted">Total Products</h5>
                                    <h2 th:text="${totalProducts}" class="fw-bold"></h2>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="card shadow-sm p-3">
                                    <h6 class="text-center mb-3 fw-semibold">Product Status Distribution</h6>
                                    <div id="productStatusChart" style="height: 300px;"></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <script th:inline="javascript">
        document.addEventListener("DOMContentLoaded", function () {
            // ======= User Data from Backend =======
            const customerCount = [[${ customerCount }]];
            const sellerCount = [[${ sellerCount }]];
            const adminCount = [[${ adminCount }]];

            // ======= Product Data from Backend =======
            const publicCount = [[${ publicCount }]];
            const pendingCount = [[${ pendingCount }]];
            const cancelledCount = [[${ cancelledCount }]];

            // ======= User Role Pie Chart =======
            const userRoleOptions = {
                series: [customerCount, sellerCount, adminCount],
                chart: {
                    type: 'pie',
                    height: 300
                },
                labels: ['Customer', 'Seller', 'Admin'],
                colors: ['#36a2eb', '#ffce56', '#4caf50'],
                legend: { position: 'bottom' },
                dataLabels: { enabled: true }
            };
            new ApexCharts(document.querySelector("#userRoleChart"), userRoleOptions).render();

            // ======= Product Status Pie Chart =======
            const productStatusOptions = {
                series: [publicCount, pendingCount, cancelledCount],
                chart: {
                    type: 'pie',
                    height: 300
                },
                labels: ['Public', 'Pending', 'Cancelled'],
                colors: ['#4caf50', '#ffc107', '#f44336'],
                legend: { position: 'bottom' },
                dataLabels: { enabled: true }
            };
            new ApexCharts(document.querySelector("#productStatusChart"), productStatusOptions).render();
        });
    </script>
    <script src="../assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="../assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/libs/apexcharts/dist/apexcharts.min.js"></script>
    <script src="../assets/libs/simplebar/dist/simplebar.js"></script>
    <script src="../assets/js/dashboard.js"></script>
    <!-- solar icons -->
    <script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>
</body>

</html>