<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin BanHangRong</title>
    <link rel="shortcut icon" th:href="@{/img/favicon.png}"/>
    <link rel="stylesheet" th:href="@{/css/styles.min.css}"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <style>

        .card {
            border: none;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        h2.fw-bold {
            color: #2b6cb0;
        }
        .sidebar-item { position: relative; list-style: none; }
        .sidebar-item > ul {
            display: none;
            margin-left: 1.5rem;
        }
        .sidebar-item:hover > ul {
            display: block;
        }
        .badge {
            background-color: #dc3545;
            color: #fff;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.8rem;
        }
    </style>
</head>

<body>
<div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full">
    <!-- Sidebar Start -->
    <div th:replace="~{admin/sidebar::sidebar}"></div>
    <!--  Sidebar End -->
    <!--  Main wrapper -->
    <div class="body-wrapper">
        <div class="body-wrapper-inner">
            <div class="container-fluid">
                <!--  Code o day -->
                <!-- DASHBOARD CONTENT -->
                <div class="container mt-4">

                    <!-- USER STATISTICS -->
                    <div class="row mb-5">
                        <div class="col-md-4">
                            <div class="card shadow-sm p-3 text-center">
                                <h5 class="text-muted">Total Users</h5>
                                <h2 th:text="${totalUsers}" class="fw-bold"></h2>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card shadow-sm p-3">
                                <h6 class="text-center mb-3 fw-semibold">User Role Distribution</h6>
                                <div id="userRoleChart" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- PRODUCT STATISTICS -->
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card shadow-sm p-3 text-center">
                                <h5 class="text-muted">Total Products</h5>
                                <h2 th:text="${totalProducts}" class="fw-bold"></h2>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card shadow-sm p-3">
                                <h6 class="text-center mb-3 fw-semibold">Product Status Distribution</h6>
                                <div id="productStatusChart" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<script th:inline="javascript">
    document.addEventListener("DOMContentLoaded", function () {
        // ======= User Data from Backend =======
        const customerCount = [[${customerCount}]];
        const sellerCount = [[${sellerCount}]];
        const adminCount = [[${adminCount}]];

        // ======= Product Data from Backend =======
        const publicCount = [[${publicCount}]];
        const pendingCount = [[${pendingCount}]];
        const cancelledCount = [[${cancelledCount}]];

        // ======= User Role Pie Chart =======
        const userRoleOptions = {
            series: [customerCount, sellerCount, adminCount],
            chart: {
                type: 'pie',
                height: 300
            },
            labels: ['Customer', 'Seller', 'Admin'],
            colors: ['#36a2eb', '#ffce56', '#4caf50'],
            legend: { position: 'bottom' },
            dataLabels: { enabled: true }
        };
        new ApexCharts(document.querySelector("#userRoleChart"), userRoleOptions).render();

        // ======= Product Status Pie Chart =======
        const productStatusOptions = {
            series: [publicCount, pendingCount, cancelledCount],
            chart: {
                type: 'pie',
                height: 300
            },
            labels: ['Public', 'Pending', 'Cancelled'],
            colors: ['#4caf50', '#ffc107', '#f44336'],
            legend: { position: 'bottom' },
            dataLabels: { enabled: true }
        };
        new ApexCharts(document.querySelector("#productStatusChart"), productStatusOptions).render();
    });
</script>
<script src="../assets/libs/jquery/dist/jquery.min.js"></script>
<script src="../assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="../assets/libs/apexcharts/dist/apexcharts.min.js"></script>
<script src="../assets/libs/simplebar/dist/simplebar.js"></script>
<script src="../assets/js/dashboard.js"></script>
<!-- solar icons -->
<script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>
</body>

</html>