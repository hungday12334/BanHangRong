<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·ªïi M·∫≠t kh·∫©u</title>
    <link rel="stylesheet" href="/css/styles.min.css">
    <style>
        :root { --bg:#f5f7fb; --card:#ffffff; --ink:#0f172a; --muted:#6b7280; --brand:#0ea5e9; --line:#eaeef4; }
        body { margin:0; font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink); background:var(--bg); }
        .topbar { display:flex; align-items:center; gap:14px; padding:10px 16px; border-bottom:1px solid var(--line); background:var(--card); flex-wrap:nowrap; }
        .brand { font-weight:800; letter-spacing:.2px; }
        .nav { display:flex; gap:16px; margin:0 12px; flex:1; overflow:auto; white-space:nowrap; }
        .nav a { text-decoration:none; color:#111827; font-weight:500; padding:8px 10px; border-radius:8px; }
        .nav a:hover { background:#f3f4f6; }
        .top-actions { margin-left:auto; display:flex; align-items:center; gap:12px; position:relative; flex-wrap:nowrap; }
        .user-btn{display:flex;align-items:center;gap:6px;cursor:pointer;color:#111827;border:1px solid var(--line);padding:6px 10px;border-radius:8px;background:#fff}
        .user-menu{position:absolute; right:0; top:48px; background:#fff; border:1px solid var(--line); border-radius:10px; box-shadow:0 10px 25px rgba(0,0,0,.08); width:200px; display:none; z-index:5}
        .user-menu .item{display:block; padding:10px 12px; color:#111827; text-decoration:none}
        .user-menu .item:hover{background:#f3f4f6}
        .layout { max-width:1000px; margin:18px auto; display:flex; gap:18px; align-items:flex-start; }
        .sidebar { width:240px; background:#fff; border:1px solid var(--line); border-radius:14px; padding:16px; position:sticky; top:18px; align-self:flex-start; }
        .sidebar .title { font-weight:700; margin-bottom:8px; }
        .sidebar a { display:block; padding:10px 12px; border-radius:10px; color:#111827; text-decoration:none; }
        .sidebar a.active, .sidebar a:hover { background:#f3f4f6; }
        .card { flex:1; background:#fff; border:1px solid var(--line); border-radius:14px; padding:24px; }
        .form-grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
        .form-group { display:flex; flex-direction:column; gap:6px; }
        .form-group label { font-size:13px; color:var(--muted); }
        .form-group input { height:40px; padding:0 10px; border:1px solid var(--line); border-radius:8px; }
        .actions { display:flex; gap:10px; justify-content:flex-end; margin-top:16px; }
        .btn { padding:10px 16px; border-radius:10px; border:1px solid var(--line); background:#fff; cursor:pointer; }
        .btn.primary { background:var(--brand); color:#fff; border-color:var(--brand); }
    </style>
</head>
<body>
<div class="topbar">
    <div class="brand">BanHangRong</div>
    <nav class="nav" aria-label="Main">
        <a href="/customer/dashboard">Home</a>
        <a href="/categories">Category</a>
        <a href="#">License Software</a>
        <a href="#">Game Keys</a>
        <a href="#">Voucher</a>
        <a href="#">Support</a>
    </nav>
    <div class="top-actions">
        <div class="notif">Notification</div>
        <div class="user" style="position:relative">
            <button id="userMenuBtn" class="user-btn" type="button" aria-haspopup="menu" aria-expanded="false">
                <span th:text="${user != null ? user.username : 'User123456'}">User123456</span>
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <div id="userDropdown" class="user-menu" role="menu" aria-label="User menu">
                <a class="item" th:href="@{'/customer/profile/' + ${user.username}}" role="menuitem">T√†i kho·∫£n c·ªßa t√¥i</a>
                <a class="item" href="#" role="menuitem" onclick="event.preventDefault(); document.getElementById('logoutForm').submit();">ƒêƒÉng xu·∫•t</a>
            </div>
            <form id="logoutForm" method="post" action="/logout" style="display:none;"></form>
        </div>
        <a href="/cart" class="cart" title="Gi·ªè h√†ng" aria-label="Gi·ªè h√†ng">üõí</a>
    </div>
</div>

<div class="layout">
    <aside class="sidebar" aria-label="Profile navigation">
        <div class="title">T√†i Kho·∫£n C·ªßa T√¥i</div>
        <a th:href="@{'/customer/profile/' + ${user.username}}">H·ªì s∆°</a>
        <a th:href="@{'/customer/profile/' + ${user.username} + '/change-password'}" class="active">ƒê·ªïi M·∫≠t kh·∫©u</a>
    </aside>
    <section class="card">
        <h2 style="margin-top:0;">ƒê·ªïi M·∫≠t kh·∫©u</h2>
        <div th:if="${pwdError != null}" class="notice" style="margin-bottom:12px;color:#dc2626;background:#fef2f2;border-color:#fecaca;" th:text="${pwdError}">L·ªói ƒë·ªïi m·∫≠t kh·∫©u.</div>
        <form th:action="@{'/customer/profile/' + ${user.username} + '/change-password'}" method="post">
            <div class="form-grid">
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                    <input type="password" name="currentPassword" autocomplete="current-password" required>
                </div>
                <div></div>
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u m·ªõi</label>
                    <input type="password" name="newPassword" autocomplete="new-password" required>
                </div>
                <div class="form-group">
                    <label>Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi</label>
                    <input type="password" name="confirmPassword" autocomplete="new-password" required>
                </div>
            </div>
            <div class="actions">
                <a th:href="@{'/customer/profile/' + ${user.username}}" class="btn">H·ªßy</a>
                <button type="submit" class="btn primary">L∆∞u</button>
            </div>
        </form>
    </section>
</div>
</body>
</html>

